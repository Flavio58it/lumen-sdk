{"version":3,"sources":["social.ts"],"names":[],"mappings":"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","file":"social.js","sourcesContent":["/// <reference path=\"../typings/main.d.ts\"/>\n/// <reference path=\"services.ts\"/>\nangular.module('starter.controllers')\n\n.controller('SocialMonitorCtrl', function($scope, $stateParams: ng.ui.IStateParamsService, \n        $log: ng.ILogService, $ionicScrollDelegate: ionic.scroll.IonicScrollDelegate, \n        ngstomp, Settings: Services.Settings) {\n    $scope.posts = [];\n\n//    var stompUri = 'http://' + window.location.hostname + ':15674/stomp';\n    var settings = Settings.getSettings();\n    $log.info('Stomp connecting to', settings.stompUri);\n    $scope.client = ngstomp(settings.stompUri);\n    $scope.client.connect(settings.stompUser, settings.stompPassword, function() {\n        $log.info('Stomp connected to', settings.stompUri);\n        $scope.client.subscribe('/topic/lumen.*.social.perception', function(msg) {\n            var post = JSON.parse(msg.body);\n            $scope.posts.push(post);\n            $ionicScrollDelegate.scrollBottom(true);\n        });\n    }, function(err) {\n        $log.error('Stomp error:', err);\n        $scope.client = null;\n    }, '/');\n})\n\n.controller('SocialExpressCtrl', function($scope, $stateParams: ng.ui.IStateParamsService, \n        $log: ng.ILogService, LumenStomp: Services.LumenStomp, Settings: Services.Settings) {\n    $scope.agentIds = ['arkan'];\n    $scope.form = {\n        agentId: 'arkan'\n    };\n\n    $scope.posts = [];\n    $scope.networks = [\n        {'id': 'facebook', 'name': 'Facebook'},\n        {'id': 'twitter', 'name': 'Twitter'}\n    ];\n    $scope.post = {network: $scope.networks[0]};\n\n    // Agent\n    $scope.switchAgent = function() {\n        LumenStomp.unsubscribeAll();\n    };\n\n    $scope.$on('$ionicView.enter', function() {\n        LumenStomp.connect(function() {\n            $scope.client = LumenStomp.getClient();\n            $scope.switchAgent();\n        });\n    });\n    $scope.$on('$ionicView.beforeLeave', function() {\n        LumenStomp.disconnect();\n    });\n\n    $scope.submit = function() {\n        $scope.communicateAction = {\n            '@type': 'CommunicateAction',\n            object: $scope.post.message,\n        };\n        var topic = 'lumen.arkan.' + $scope.post.network.id + '.timeline.out';\n        $log.info('Posting to', topic, ':', JSON.stringify($scope.communicateAction));\n        $scope.client.send('/topic/' + topic, {}, JSON.stringify($scope.communicateAction));\n    };\n});"],"sourceRoot":"/source/"}